#
# Include files from subdirectories
#
include stdlib/Files
include system/Files
include util/Files
include unix/Files

STDLIB_FILES  = $(file $(addprefix stdlib/,  $(STDLIB_FILES)))
SYSTEM_FILES  = $(file $(addprefix system/,  $(SYSTEM_FILES)))
UTIL_FILES    = $(file $(addprefix util/,    $(UTIL_FILES)))
UNIX_FILES    = $(file $(addprefix unix/,    $(UNIX_FILES)))

FILES[] =
    $(STDLIB_FILES)
    $(UNIX_FILES)
    $(SYSTEM_FILES)
    $(UTIL_FILES)

USE_OCAMLFIND = false

if $(not $(defined LMINSTALL))
    LMINSTALL = false
    export

if $(LMINSTALL)
    OCamlLibraryInstall($(LMINSTALL), $(LIB), lm, $(FILES))
else
    OCamlLibrary(lm, $(FILES))

clean:
    $(CLEAN)

#
# Configuration
#
if $(not $(defined LM_STANDALONE))
    LM_STANDALONE = false
    export

if $(not $(defined CAMLLIB))
    CAMLLIB = $(dir $(getenv CAMLLIB, $(getenv OCAMLLIB, $(shell $(OCAMLC) -where))))
    INCLUDES += $(CAMLLIB)
    export

LIBFILES =
if $(NATIVE_ENABLED)
    LIBFILES += lm.cmxa lm$(EXT_LIB)
    export
if $(BYTE_ENABLED)
    LIBFILES += lm.cma
    export

if $(LM_STANDALONE)
   .DEFAULT: $(LIBFILES)

if $(not $(defined THREADS_ENABLED))
    THREADS_ENABLED = false
    export

#
# Subdirectories of this project
#
.SUBDIRS: cutil stdlib unix system util
