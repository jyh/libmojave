#
# LibMojave C files
#
CFILES[] =
    lm_heap
    lm_abstract
    lm_float
    lm_ncurses
    lm_printf
    lm_raw
    lm_readline
    lm_rusage
    lm_terminfo
    lm_mmap
    lm_marshal_shared
    lm_ssl
    lm_config
    lm_uname_ext
    lm_channel
    lm_ctype
    lm_nocompare
    lm_compat_win32
    lm_unix_cutil
    fam_win32
    fam_kqueue
    fam_inotify
    lm_notify

#
# XXX: snprintf.om will be added in OMake 0.9.8
#
if $(test -r $(STDLIB)/configure/snprintf.om)
    include $(STDLIB)/configure/snprintf.om
    export
else
    # XXX: HACK
    static. =
        print($"--- Checking snprintf availability... ")
        SNPRINTF_AVAILABLE = $(CheckLib $(EMPTY), snprintf)
        println($"""($(if $(not $(SNPRINTF_AVAILABLE)), $"NOT ")found)""")
    export

if $(SNPRINTF_AVAILABLE)
    CFLAGS += -DHAVE_SNPRINTF
    export

#
# Libraries
#
StaticCLibraryInstall($(LMINSTALL), $(LIB), liblmcutil, $(CFILES))

if $(LM_STANDALONE)
    .DEFAULT: liblmcutil$(EXT_LIB)

clean:
    $(CLEAN)
